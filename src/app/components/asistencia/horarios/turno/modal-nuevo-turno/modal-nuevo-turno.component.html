<div class="bg-white rounded shadow p-6 w-full max-w-6xl mx-auto">
  <h2 class="text-xl font-semibold mb-4">Nuevo Turno</h2>

  <!-- Nombre del Turno -->
  <div class="mb-4">
    <label class="block text-sm font-medium text-gray-700 mb-1">Nombre del Turno</label>
    <input
      type="text"
      [(ngModel)]="nombreTurno"
      placeholder="Ingrese nombre del turno"
      class="w-full border border-gray-300 rounded px-3 py-2 text-sm focus:outline-none focus:ring focus:border-blue-400"
    />
    <label class="inline-flex items-center mt-2 text-sm text-green-700">
      <input type="checkbox" [(ngModel)]="turnoAutomatico" class="form-checkbox mr-2 text-green-600" /> Turno Automático
    </label>
  </div>

  <!-- Tablas -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
    <!-- Horarios disponibles -->
    <div>
      <h3 class="text-sm font-semibold mb-2">Horarios Disponibles</h3>
      <div class="overflow-x-auto max-h-72 overflow-y-auto border rounded">
        <table class="min-w-full text-sm border border-gray-200">
          <thead class="bg-gray-100">
            <tr>
              <th class="p-2 border">Seleccionar</th>
              <th class="p-2 border">Nombre</th>
              <th class="p-2 border">Entrada</th>
              <th class="p-2 border">Salida</th>
              <th class="p-2 border">Descanso</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let horario of dataHorarios" class="hover:bg-gray-50">
              <td class="p-2 border text-center">
                <input
                  type="checkbox"
                  (click)="$event.stopPropagation()"
                  (change)="toggleHorarioSelection(horario)"
                  [checked]="isSelected(horario)"
                  class="form-checkbox text-blue-600"
                />
              </td>
              <td class="p-2 border">{{ horario.nombre }}</td>
              <td class="p-2 border">{{ horario.horaEntrada }}</td>
              <td class="p-2 border">{{ horario.horaSalida }}</td>
              <td class="p-2 border">{{ horario.descanso }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Horario Semanal -->
    <div>
      <h3 class="text-sm font-semibold mb-2">Horario Semanal</h3>

      <div class="flex gap-3 mb-2">
        <select [(ngModel)]="tipoVistaHorario" class="border rounded px-3 py-2 text-sm">
          <option value="Dia">Día</option>
          <option value="Semana">Semana</option>
          <option value="Mes">Mes</option>
        </select>

        <input
          type="number"
          [(ngModel)]="cicloValor"
          min="1"
          (ngModelChange)="onCicloValorChange()"
          placeholder="1"
          class="w-20 border rounded px-3 py-2 text-sm"
        />
      </div>

      <div class="overflow-x-auto">
        <ng-container [ngSwitch]="tipoVistaHorario">
          <!-- Vista Día -->
          <table *ngSwitchCase="'Dia'" class="min-w-full border">
            <thead>
              <tr><th class="p-2 text-sm">Horario</th></tr>
            </thead>
            <tbody>
              <tr *ngFor="let row of horariosDiaPorFila; let i = index">
                <td class="p-2">
                  <div class="cursor-pointer border rounded p-2" (click)="asignarHorariosSeleccionadosADia(i)" (dblclick)="limpiarHorariosDiaCelda(i)">
                    <div class="flex flex-wrap gap-1">
                      <span *ngFor="let horario of row" class="bg-gray-200 px-2 py-1 rounded text-xs">{{ horario.nombre }}</span>
                    </div>
                    <p class="text-gray-500 text-xs mt-1">Click para asignar - Doble click para limpiar</p>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>

          <!-- Vista Semana -->
          <table *ngSwitchCase="'Semana'" class="min-w-full border">
            <thead>
              <tr>
                <th *ngFor="let dia of diasSemana" class="p-2 text-sm">{{ dia }}</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let row of horariosSemanaPorFila; let i = index">
                <td *ngFor="let dia of diasSemana" class="p-2">
                  <div class="cursor-pointer border rounded p-2" (click)="asignarHorariosSeleccionadosASemana(i, dia)" (dblclick)="limpiarHorariosSemanaCelda(i, dia)">
                    <div class="flex flex-wrap gap-1">
                      <span *ngFor="let horario of row[dia]" class="bg-gray-200 px-2 py-1 rounded text-xs">{{ horario.nombre }}</span>
                    </div>
                    <p class="text-gray-500 text-xs mt-1">Click para asignar - Doble click para limpiar</p>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>

          <!-- Vista Mes -->
          <table *ngSwitchCase="'Mes'" class="min-w-full border">
            <thead>
              <tr>
                <th *ngFor="let dia of diasMes; let j = index" class="p-2 text-sm">{{ j + 1 }}</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let row of horariosMesPorFila; let i = index">
                <td *ngFor="let cell of row; let j = index" class="p-2">
                  <div class="cursor-pointer border rounded p-2" (click)="asignarHorariosSeleccionadosAMes(i, j)" (dblclick)="limpiarHorariosMesCelda(i, j)">
                    <div class="flex flex-wrap gap-1">
                      <span *ngFor="let horario of cell" class="bg-gray-200 px-2 py-1 rounded text-xs">{{ horario.nombre }}</span>
                    </div>
                    <p class="text-gray-500 text-xs mt-1">Click para asignar - Doble click para limpiar</p>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </ng-container>
      </div>
    </div>
  </div>

  <!-- Botones acciones -->
  <div class="mt-6 flex justify-end gap-2">
    <button (click)="cancelar()" class="px-4 py-2 text-sm border rounded text-gray-600 hover:bg-gray-100">Cancelar</button>
    <button (click)="guardarTurno()" class="px-4 py-2 text-sm bg-blue-600 text-white rounded hover:bg-blue-700">Guardar</button>
  </div>
</div>
