<div class="mt-8 mx-auto max-w-6xl">
  <div class="flex items-center gap-2 mb-4">
    <button mat-stroked-button class="px-3 py-1.5 text-sm border border-red-500 text-red-600 hover:bg-red-50 rounded" (click)="eliminarSeleccionados()">
      <small>Borrar</small>
    </button>
    <button mat-stroked-button class="px-3 py-1.5 text-sm border border-blue-500 text-blue-600 hover:bg-blue-50 rounded" (click)="openModalNuevoDescanso()">
      <small>Nuevo Descanso</small>
    </button>
  </div>

  <div class="overflow-x-auto bg-white border rounded shadow-sm">
    <table class="min-w-full text-sm text-left">
      <thead class="bg-gray-100">
        <tr>
          <th class="px-2 py-2 text-center">
            <input type="checkbox" aria-label="Seleccionar todos">
          </th>
          <th class="px-2 py-2">Nombre</th>
          <th class="px-2 py-2">DNI</th>
          <th class="px-2 py-2">Asignar Horario</th>
          <th class="px-2 py-2"></th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let emp of empleados" class="border-t hover:bg-gray-50">
          <td class="px-2 py-1 text-center">
            <input type="checkbox" aria-label="Seleccionar empleado">
          </td>
          <td class="px-2 py-1">{{emp.apellido_Paterno}} {{emp.apellido_Materno}}, {{emp.nombres}}</td>
          <td class="px-2 py-1">{{emp.nro_Doc}}</td>
          <td class="px-2 py-1">
            <mat-form-field appearance="fill" class="w-60">
              <mat-label>Horario</mat-label>
              <mat-select [(value)]="asignaciones[emp.personal_Id]" panelClass="horario-panel">
                <mat-option>
                  <input
                    type="text"
                    placeholder="Buscar horario..."
                    [(ngModel)]="filtrosHorarios[emp.personal_Id]"
                    (click)="$event.stopPropagation()"
                    (keyup)="filtrarHorarios(emp.personal_Id)"
                    class="w-full px-2 py-1 text-sm border border-gray-300 rounded"
                  />
                </mat-option>
                <mat-option *ngFor="let h of horariosFiltrados[emp.personal_Id] || horarios" [value]="h.id">
                  {{ h.alias }}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </td>
          <td class="px-2 py-1 text-right">
            <button mat-icon-button (click)="guardarAsignacion(emp.personal_Id)">
              <mat-icon fontIcon="check_circle" class="text-green-500"></mat-icon>
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="mt-4 flex justify-end">
    <mat-paginator
      [length]="empleados.length"
      [pageSize]="pageSize"
      [pageIndex]="pageNumber - 1"
      (page)="handlePageEvent($event)"
      [pageSizeOptions]="[5, 10, 20, 50]"
      showFirstLastButtons>
    </mat-paginator>
  </div>
</div>

<style>
::ng-deep .horario-panel .mat-select-panel {
  max-height: 350px;
}
</style>
